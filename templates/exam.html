{% extends 'base.html' %}

{% block head %}
<title>Digital SAT Mock Test</title>
<link rel="stylesheet" href="{{ url_for('static', filename='exam.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <header>
        <!-- <div class="timer">0:00</div> -->
        <div id="timer">Time Left: <span id="time"></span></div>
        <div class="section-title">
            <h2>
                Section <span>{{ current_question.section }}</span>: Module <span>{{ current_question.module }}</span> 
                {% if current_question.category == 'sat-verbal' %}
                    <span>Reading and Writing</span>
                {% else %}
                    <span>Math</span>
                {% endif %}
            </h2>
            
        </div>
        <!-- <button class="btn-hide">Hide</button> -->
    </header>
    <div class="question-container">

        <div class="column">
            {% if current_question.question_header %}
                <div class="question">{{ current_question.question_header|safe }}</div>
            {% else %}
                <div class="question">Some text.</div>
            {% endif %}
            {% if current_question.question_img %}
                <img class="question-img" src="{{ url_for('static', filename='{}'.format(current_question.question_img)) }}" alt=""/>
            {% endif %}
            
        </div>
        
        
        <div class="column">
            <p class="question-2"> <span class="question-number">{{ current_question.question_id }}.</span> {{ current_question.question_query }}</p>
            <div class="answers">
                
                <!-- Radio buttons for answer choices -->
                <form action="/next" method="post">
                    {% if current_question.question_type == 'choices' %}
                        <input type="radio" id="answer_a" name="answer" value="answer_a">
                        <label class="choice-label" for="answer_a">{{ current_question.answer_a }}</label><br>
                        <input type="radio" id="answer_b" name="answer" value="answer_b">
                        <label class="choice-label" for="answer_b">{{ current_question.answer_b }}</label><br>
                        <input type="radio" id="answer_c" name="answer" value="answer_c">
                        <label class="choice-label" for="answer_c">{{ current_question.answer_c }}</label><br>
                        <input type="radio" id="answer_d" name="answer" value="answer_d">
                        <label class="choice-label" for="answer_d">{{ current_question.answer_d }}</label><br>
                    {% else %}
                        <input type="text" name="answer" required>
                    {% endif %}
                    <div class="control-button">
                        <button type="submit" class="btn-next">Next</button>
                        <input type="hidden" name="question_id" value="{{ current_question.question_id + 1 }}">
                    </div>
                </form>
                <div class="control-button">
                    <form action="/next" method="post">
                        <button type="submit" class="btn-back">Previous</button>
                        {% if current_question.question_id == 1 %}
                            <input type="hidden" name="question_id" value="{{ current_question.question_id }}">
                        {% else %}
                            <input type="hidden" name="question_id" value="{{ current_question.question_id - 1 }}">
                        {% endif %}
                    </form>
                </div>
                
            </div>
        </div>

    </div>
    {% if current_question.category == 'sat-math' %}
    <div class="text-center">
        <div class="align-bottom">
            <a class="link" href="https://www.desmos.com/calculator" target="_blank">Graphical Calculator</a> 
        </div>
    </div>
    {% endif %}
    <footer>
        <!-- Add any footer if needed -->
    </footer>
    <script>
        // Set the timer duration in seconds (e.g., 30 minutes)
        var timerDuration = 32 * 60;
        var timerElement = document.getElementById('time');

        function updateTimer() {
            var minutes = Math.floor(timerDuration / 60);
            var seconds = timerDuration % 60;
            timerElement.textContent = minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
            timerDuration--;
            if (timerDuration < 0) {
                clearInterval(timerInterval);
                // Submit the form when the timer reaches 0
                document.querySelector('form').submit();
            }
        }

        // Update the timer every second
        var timerInterval = setInterval(updateTimer, 1000);
        updateTimer(); // Initial call to updateTimer
    </script>
</div>
{% endblock %}
